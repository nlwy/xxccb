<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ˜é“äº‘è‡ªåŠ¨åŒ–æµç¨‹ä»£ç </title>
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/styles/atom-one-dark.min.css">
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.0.0/build/highlight.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();

  </script>
  <style>
    textarea {
      opacity: 0;
      width: 0;
      height: 0;
    }

    button {
      background: lightseagreen;
      border: none;
      color: #fff;
      border: 0;
      border-radius: 30px;
      line-height: 30px;
      width: 80px;
    }

    button:active {
      background: turquoise;
      outline: transparent;
    }

  </style>
</head>

<body>

  <h2>è‡ªåŠ¨åŒ–ä»£ç </h2>
  <hr>
  <h4>æœ€æ–°ç‰ˆæœ¬ï¼šv1.0.5</h4>
  <h4>æ›´æ–°æ—¥æœŸï¼š2020å¹´05æœˆ21æ—¥16:01:52</h4>
  <pre><code class="text">
  æ›´æ–°æ—¥å¿—
  v1.0.4
    1.æ–°å¢ä¸Šä¼ å›¾ç‰‡/é™„ä»¶
  v1.0.3
    1.æ–°å¢è·å–äº§å“åç§°åˆ—è¡¨
    2.æ–°å¢å›¾ç‰‡/é™„ä»¶æ‰¹é‡ä¸‹è½½
  v1.0.2ï¼š
    1.ä¼˜åŒ–äº†æ–°å¢è®°å½•æµç¨‹
    2.å¢åŠ äº†æœªæ‰¾åˆ°æç¤º
  v1.0.1ï¼š
    1.å¢åŠ äº†æµç¨‹è¯¦ç»†æ­¥éª¤
    2.å¯ä»¥è®¾ç½®æµç¨‹æ—¶é—´timeé»˜è®¤100ms
  </pre></code>
  <pre><code class="js">ä½¿ç”¨æ–¹æ³•ï¼šæ‰“å¼€æµè§ˆå™¨ -> å¼€å‘è€…å·¥å…· -> æ§åˆ¶å° -> ç²˜è´´ä»£ç  -> ç‚¹å‡»ç¡®å®š</code></pre>
  <h3>1.æµç¨‹æ–°å¢è®°å½•</h3>
  <button class="btn" data-clipboard-target="#js1">ä¸€é”®å¤åˆ¶</button>
  <textarea id="js1">"use strict";

    var index = {
      init: function init() {
        this.number = 0;
        this.length = 100;
        this.time = 100; //è§¦å‘æ—¶é—´
    
        this.addItem();
        console.log("%c ***** \u81EA\u52A8\u5316\u5F00\u59CB\uFF01\u89E6\u53D1\u65F6\u95F4".concat(this.time, "\u6BEB\u79D2\u3002 ***** "), 'color: green');
      },
      //æ·»åŠ å­—æ®µ   
      addItem: async function addItem() {
        this.itemsListBox = $('.workflowDetailBox');
        this.length = $('.workflowDetailBox > .relative').length;
        this.itemListbox = $('.workflowDetailBox > .relative').eq(this.number);
        await this.setTo(this.itemListbox); //è®¾ä¸º  
    
        await this.selectPeople(this.itemListbox); //é€‰æ‹©äººå‘˜
    
        this.number++;
        console.log("%c ***** \u6B63\u5728\u6DFB\u52A0\u7B2C".concat(this.number, "\u4E2A\u5B57\u6BB5,\u4E00\u5171").concat(this.length, "\u4E2A\u5B57\u6BB5! *****"), 'color: red');
        this.number < this.length ? this.addItem() : console.log("%c ***** \u81EA\u52A8\u5316\u7ED3\u675F,\u4E00\u5171\u7528\u65F6".concat((this.number * this.time / 60).toFixed(2), "\u79D2 *****"), 'color: green');
      },
      //è®¾ä¸º  
      setTo: function setTo(dom) {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.actionControlMore.ThemeColor3.tip-bottom-left').click();
            }());
          }, _this.time);
        });
      },
      //é€‰æ‹©äººå‘˜
      selectPeople: function selectPeople(dom) {
        var _this2 = this;
    
        var that = this;
        this.value = dom.find('.mTop15.ellipsis.Font13').text();
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              var isFind = false;
              dom.find('.conditionFieldBox li').each(function (index, item) {
                if ($(item).text().indexOf(_this2.value) !== -1) {
                  $(item).click();
                  isFind = true;
                  return true;
                }
              });
              if (!isFind) console.log("%c ***** \u672A\u627E\u5230[".concat(_this2.value, "]\u9009\u9879,\u8BF7\u624B\u52A8\u9009\u62E9\u3002*****"), 'color: yellow');
            }());
          }, _this2.time);
        });
      }
    };
    index.init();</textarea>
  <pre><code class="js" id="js1">"use strict";

    var index = {
      init: function init() {
        this.number = 0;
        this.length = 100;
        this.time = 100; //è§¦å‘æ—¶é—´
    
        this.addItem();
        console.log("%c ***** \u81EA\u52A8\u5316\u5F00\u59CB\uFF01\u89E6\u53D1\u65F6\u95F4".concat(this.time, "\u6BEB\u79D2\u3002 ***** "), 'color: green');
      },
      //æ·»åŠ å­—æ®µ   
      addItem: async function addItem() {
        this.itemsListBox = $('.workflowDetailBox');
        this.length = $('.workflowDetailBox > .relative').length;
        this.itemListbox = $('.workflowDetailBox > .relative').eq(this.number);
        await this.setTo(this.itemListbox); //è®¾ä¸º  
    
        await this.selectPeople(this.itemListbox); //é€‰æ‹©äººå‘˜
    
        this.number++;
        console.log("%c ***** \u6B63\u5728\u6DFB\u52A0\u7B2C".concat(this.number, "\u4E2A\u5B57\u6BB5,\u4E00\u5171").concat(this.length, "\u4E2A\u5B57\u6BB5! *****"), 'color: red');
        this.number < this.length ? this.addItem() : console.log("%c ***** \u81EA\u52A8\u5316\u7ED3\u675F,\u4E00\u5171\u7528\u65F6".concat((this.number * this.time / 60).toFixed(2), "\u79D2 *****"), 'color: green');
      },
      //è®¾ä¸º  
      setTo: function setTo(dom) {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.actionControlMore.ThemeColor3.tip-bottom-left').click();
            }());
          }, _this.time);
        });
      },
      //é€‰æ‹©äººå‘˜
      selectPeople: function selectPeople(dom) {
        var _this2 = this;
    
        var that = this;
        this.value = dom.find('.mTop15.ellipsis.Font13').text();
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              var isFind = false;
              dom.find('.conditionFieldBox li').each(function (index, item) {
                if ($(item).text().indexOf(_this2.value) !== -1) {
                  $(item).click();
                  isFind = true;
                  return true;
                }
              });
              if (!isFind) console.log("%c ***** \u672A\u627E\u5230[".concat(_this2.value, "]\u9009\u9879,\u8BF7\u624B\u52A8\u9009\u62E9\u3002*****"), 'color: yellow');
            }());
          }, _this2.time);
        });
      }
    };
    index.init();
  </code></pre>
  <h3>2.æµç¨‹æ›´æ–°è®°å½•</h3>
  <button class="btn" data-clipboard-target="#js2">ä¸€é”®å¤åˆ¶</button>
  <textarea id="js2">"use strict";

    var index = {
      init: function init() {
        this.number = 0;
        this.length = 100;
        this.time = 100; //è§¦å‘æ—¶é—´
    
        this.addItem();
        console.log("%c ***** \u81EA\u52A8\u5316\u5F00\u59CB\uFF01\u89E6\u53D1\u65F6\u95F4".concat(this.time, "\u6BEB\u79D2\u3002 ***** "), 'color: green');
      },
      //æ·»åŠ å­—æ®µ   
      addItem: async function addItem() {
        this.addButtonDiv = $('.addActionBtn.mTop25');
        this.addButton = this.addButtonDiv.find('.ThemeBorderColor3');
        this.addButton.click();
        await this.selectAction(this.addButtonDiv.prev()); //é€‰æ‹©å­—æ®µ
    
        await this.selectMenu(); //ç¡®å®šå­—æ®µ
    
        await this.setTo(this.addButtonDiv.prev()); //è®¾ä¸º  
    
        await this.selectPeople(this.addButtonDiv.prev()); //é€‰æ‹©äººå‘˜
    
        this.number++;
        console.log("%c ***** \u6B63\u5728\u6DFB\u52A0\u7B2C".concat(this.number, "\u4E2A\u5B57\u6BB5,\u4E00\u5171").concat(this.length, "\u4E2A\u5B57\u6BB5! *****"), 'color: red');
    
        if (this.number < this.length) {
          this.addItem();
        } else {
          console.log("%c ***** \u81EA\u52A8\u5316\u7ED3\u675F,\u4E00\u5171\u7528\u65F6".concat((this.number * this.time / 60).toFixed(2), "\u79D2 *****"), 'color: green');
        } // this.number < this.length && 
    
      },
      //é€‰æ‹©å­—æ®µ
      selectAction: function selectAction(dom) {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.Dropdown--input.Dropdown--border').click();
            }());
          }, _this.time);
        });
      },
      //ç¡®å®šå­—æ®µ
      selectMenu: function selectMenu() {
        var _this2 = this;
    
        var that = this;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              _this2.length = $('.ming.Menu.ming.List li').length;
              var dom = $('.ming.Menu.ming.List li').eq(that.number);
              that.value = dom.text();
              dom.click();
            }());
          }, _this2.time);
        });
      },
      //è®¾ä¸º  
      setTo: function setTo(dom) {
        var _this3 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.actionControlMore.ThemeColor3.tip-bottom-left').click();
            }());
          }, _this3.time);
        });
      },
      //é€‰æ‹©äººå‘˜
      selectPeople: function selectPeople(dom) {
        var _this4 = this;
    
        var that = this;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.conditionFieldBox li').each(function (index, item) {
                if ($(item).text() === _this4.value) {
                  $(item).click();
                }
              });
            }());
          }, _this4.time);
        });
      }
    };
    index.init();</textarea>
  <pre><code class="js">"use strict";

    var index = {
      init: function init() {
        this.number = 0;
        this.length = 100;
        this.time = 100; //è§¦å‘æ—¶é—´
    
        this.addItem();
        console.log("%c ***** \u81EA\u52A8\u5316\u5F00\u59CB\uFF01\u89E6\u53D1\u65F6\u95F4".concat(this.time, "\u6BEB\u79D2\u3002 ***** "), 'color: green');
      },
      //æ·»åŠ å­—æ®µ   
      addItem: async function addItem() {
        this.addButtonDiv = $('.addActionBtn.mTop25');
        this.addButton = this.addButtonDiv.find('.ThemeBorderColor3');
        this.addButton.click();
        await this.selectAction(this.addButtonDiv.prev()); //é€‰æ‹©å­—æ®µ
    
        await this.selectMenu(); //ç¡®å®šå­—æ®µ
    
        await this.setTo(this.addButtonDiv.prev()); //è®¾ä¸º  
    
        await this.selectPeople(this.addButtonDiv.prev()); //é€‰æ‹©äººå‘˜
    
        this.number++;
        console.log("%c ***** \u6B63\u5728\u6DFB\u52A0\u7B2C".concat(this.number, "\u4E2A\u5B57\u6BB5,\u4E00\u5171").concat(this.length, "\u4E2A\u5B57\u6BB5! *****"), 'color: red');
    
        if (this.number < this.length) {
          this.addItem();
        } else {
          console.log("%c ***** \u81EA\u52A8\u5316\u7ED3\u675F,\u4E00\u5171\u7528\u65F6".concat((this.number * this.time / 60).toFixed(2), "\u79D2 *****"), 'color: green');
        } // this.number < this.length && 
    
      },
      //é€‰æ‹©å­—æ®µ
      selectAction: function selectAction(dom) {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.Dropdown--input.Dropdown--border').click();
            }());
          }, _this.time);
        });
      },
      //ç¡®å®šå­—æ®µ
      selectMenu: function selectMenu() {
        var _this2 = this;
    
        var that = this;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              _this2.length = $('.ming.Menu.ming.List li').length;
              var dom = $('.ming.Menu.ming.List li').eq(that.number);
              that.value = dom.text();
              dom.click();
            }());
          }, _this2.time);
        });
      },
      //è®¾ä¸º  
      setTo: function setTo(dom) {
        var _this3 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.actionControlMore.ThemeColor3.tip-bottom-left').click();
            }());
          }, _this3.time);
        });
      },
      //é€‰æ‹©äººå‘˜
      selectPeople: function selectPeople(dom) {
        var _this4 = this;
    
        var that = this;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              dom.find('.conditionFieldBox li').each(function (index, item) {
                if ($(item).text() === _this4.value) {
                  $(item).click();
                }
              });
            }());
          }, _this4.time);
        });
      }
    };
    index.init();</code></pre>
  <h3>3.è·å–äº§å“åç§°åˆ—è¡¨</h3>
  <button class="btn" data-clipboard-target="#js3">ä¸€é”®å¤åˆ¶</button>
  <textarea id="js3">"use strict";

var index = {
  init: function init() {
    this.number = $('.main-right-grid .editableCellCon')[0].classList[2].split('-')[1];
    this.productList = [];
    this.addProductPicture();
  },
  //è·å–äº§å“åˆ—è¡¨
  addProductPicture: function addProductPicture() {
    var table = $('.main-right-grid');
    var row = table.find(".row-".concat(this.number, ".col-4"));
    var text = row.find('span').text();

    if (row.length !== 0) {
      this.productList.push(text);
      this.number++;
      this.addProductPicture();
    } else {
      console.log(JSON.stringify(this.productList));
    }
  }
};
index.init();
  </textarea>
  <pre><code class="js">"use strict";

    var index = {
      init: function init() {
        this.number = $('.main-right-grid .editableCellCon')[0].classList[2].split('-')[1];
        this.productList = [];
        this.addProductPicture();
      },
      //è·å–äº§å“åˆ—è¡¨
      addProductPicture: function addProductPicture() {
        var table = $('.main-right-grid');
        var row = table.find(".row-".concat(this.number, ".col-4"));
        var text = row.find('span').text();
    
        if (row.length !== 0) {
          this.productList.push(text);
          this.number++;
          this.addProductPicture();
        } else {
          console.log(JSON.stringify(this.productList));
        }
      }
    };
    index.init();
  </code></pre>
  <h3>4.è·å–å›¾ç‰‡åˆ—è¡¨å¹¶æ‰¹é‡ä¸‹è½½å›¾ç‰‡(å°†3ä¸­è·å–çš„äº§å“æ›¿æ¢åˆ°this.values)</h3>
  <button class="btn" data-clipboard-action="cut" data-clipboard-target="#js4">ä¸€é”®å¤åˆ¶</button>
  <textarea id="js4">"use strict";

    var index = {
      init: function init() {
        //è¯·å°†äº§å“åˆ—è¡¨æ›¿æ¢åˆ°è¿™é‡Œ     
        this.values = ["é›ªèŠ±9å·å•¤é…’", "é›ªèŠ±å•¤é…’ç“¶å¬å–œåŠ›å•¤é…’ç“¶å¬é‡‘å¨å•¤é…’ç“¶å¬", "365å…¨éº¦ç²¾é…¿å•¤é…’", "ç—¹ç—›å†·æ•·è´´"];
        this.getProductList();
        this.data = [];
        this.number = 0;
        this.time = 1000;
      },
      // è·å– blob
      getBlob: function getBlob(url, cb) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'blob';
    
        xhr.onload = function () {
          if (xhr.status === 200) {
            cb(xhr.response);
          }
        };
    
        xhr.send();
      },
      // ä¿å­˜æ–‡ä»¶
      saveAs: function saveAs(blob, filename) {
        if (window.navigator.msSaveOrOpenBlob) {
          navigator.msSaveBlob(blob, filename);
        } else {
          var link = document.createElement('a');
          var body = document.querySelector('body');
          link.href = window.URL.createObjectURL(blob);
          link.download = filename; // fix Firefox
    
          link.style.display = 'none';
          body.appendChild(link);
          link.click();
          body.removeChild(link);
          window.URL.revokeObjectURL(link.href);
        }
    
        ;
        console.log("%c ****".concat(filename, "\u4E0B\u8F7D\u6210\u529F!****"), 'color:red');
      },
      // ä¸‹è½½æ–‡ä»¶
      download: function download(url, filename) {
        var that = this;
        return that.getBlob(url, function (blob) {
          that.saveAs(blob, filename);
        });
      },
      //è·å–äº§å“ä¿¡æ¯
      getProductList: async function getProductList() {
        var _this = this;
    
        var data = JSON.stringify({
          appId: 'a58e759f-8e1d-4dc9-b70a-4f86c98a27d5',
          viewId: '5ea19a772fc9510001e27cc5',
          worksheetId: '5ea19a772fc9510001e27cc4',
          status: 1,
          pageIndex: 1,
          sortControls: [],
          pageSize: 50,
          keyWords: '',
          searchType: 1,
          filterControls: [{
            controlId: '5ea1af554f222e0001d9fd8e',
            dataType: 2,
            spliceType: 1,
            filterType: 1,
            values: this.values
          }],
          isUnRead: false
        });
        console.log('%c ****è·å–å›¾ç‰‡ä¿¡æ¯å¼€å§‹****', 'color: green');
        var dataList = await $.ajax({
          type: "POST",
          contentType: "application/json;charset=UTF-8",
          url: 'https://www.mingdao.com/api/Worksheet/GetFilterRows',
          data: data,
          dataType: 'json'
        }).then(function (data) {
          return data.data.data;
        });
        console.log('%c ****å¼€å§‹ä¸‹è½½å›¾ç‰‡****', 'color:red');
        console.log("%c ****\u4E00\u5171".concat(dataList.length, "\u6761\u6570\u636E****"), 'color:red');
        dataList.forEach(function (item) {
          var value = JSON.parse(item['5ea1af554f222e0001d9fd97']);
          value.forEach(function (itemList, index) {
            itemList.previewUrl = itemList.previewUrl.split("?")[0];
          });
    
          _this.data.push({
            name: item['5ea1af554f222e0001d9fd8e'],
            value: value
          });
        });
        this.downloadFile();
      },
      //ä¸‹è½½æ–‡ä»¶   
      downloadFile: async function downloadFile() {
        await this.saveFile(this.data[this.number]);
        this.number < this.data.length ? this.downloadFile() : console.log('%c ****ä¸‹è½½æœ€åä¸€ä¸ªå•†å“é™„ä»¶****', 'color: green');
      },
      saveFile: function saveFile(list) {
        var _this2 = this;
    
        this.number++;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              list.value.forEach(function (item, index) {
                _this2.download(item.previewUrl, "".concat(list.name, "_").concat(index).concat(item.ext));
              });
            }());
          }, _this2.time);
        });
      }
    };
    index.init();
  </textarea>
  <pre><code class="js">"use strict";

    var index = {
      init: function init() {
        //è¯·å°†äº§å“åˆ—è¡¨æ›¿æ¢åˆ°è¿™é‡Œ     
        this.values = ["é›ªèŠ±9å·å•¤é…’", "é›ªèŠ±å•¤é…’ç“¶å¬å–œåŠ›å•¤é…’ç“¶å¬é‡‘å¨å•¤é…’ç“¶å¬", "365å…¨éº¦ç²¾é…¿å•¤é…’", "ç—¹ç—›å†·æ•·è´´"];
        this.getProductList();
        this.data = [];
        this.number = 0;
        this.time = 1000;
      },
      // è·å– blob
      getBlob: function getBlob(url, cb) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'blob';
    
        xhr.onload = function () {
          if (xhr.status === 200) {
            cb(xhr.response);
          }
        };
    
        xhr.send();
      },
      // ä¿å­˜æ–‡ä»¶
      saveAs: function saveAs(blob, filename) {
        if (window.navigator.msSaveOrOpenBlob) {
          navigator.msSaveBlob(blob, filename);
        } else {
          var link = document.createElement('a');
          var body = document.querySelector('body');
          link.href = window.URL.createObjectURL(blob);
          link.download = filename; // fix Firefox
    
          link.style.display = 'none';
          body.appendChild(link);
          link.click();
          body.removeChild(link);
          window.URL.revokeObjectURL(link.href);
        }
    
        ;
        console.log("%c ****".concat(filename, "\u4E0B\u8F7D\u6210\u529F!****"), 'color:red');
      },
      // ä¸‹è½½æ–‡ä»¶
      download: function download(url, filename) {
        var that = this;
        return that.getBlob(url, function (blob) {
          that.saveAs(blob, filename);
        });
      },
      //è·å–äº§å“ä¿¡æ¯
      getProductList: async function getProductList() {
        var _this = this;
    
        var data = JSON.stringify({
          appId: 'a58e759f-8e1d-4dc9-b70a-4f86c98a27d5',
          viewId: '5ea19a772fc9510001e27cc5',
          worksheetId: '5ea19a772fc9510001e27cc4',
          status: 1,
          pageIndex: 1,
          sortControls: [],
          pageSize: 50,
          keyWords: '',
          searchType: 1,
          filterControls: [{
            controlId: '5ea1af554f222e0001d9fd8e',
            dataType: 2,
            spliceType: 1,
            filterType: 1,
            values: this.values
          }],
          isUnRead: false
        });
        console.log('%c ****è·å–å›¾ç‰‡ä¿¡æ¯å¼€å§‹****', 'color: green');
        var dataList = await $.ajax({
          type: "POST",
          contentType: "application/json;charset=UTF-8",
          url: 'https://www.mingdao.com/api/Worksheet/GetFilterRows',
          data: data,
          dataType: 'json'
        }).then(function (data) {
          return data.data.data;
        });
        console.log('%c ****å¼€å§‹ä¸‹è½½å›¾ç‰‡****', 'color:red');
        console.log("%c ****\u4E00\u5171".concat(dataList.length, "\u6761\u6570\u636E****"), 'color:red');
        dataList.forEach(function (item) {
          var value = JSON.parse(item['5ea1af554f222e0001d9fd97']);
          value.forEach(function (itemList, index) {
            itemList.previewUrl = itemList.previewUrl.split("?")[0];
          });
    
          _this.data.push({
            name: item['5ea1af554f222e0001d9fd8e'],
            value: value
          });
        });
        this.downloadFile();
      },
      //ä¸‹è½½æ–‡ä»¶   
      downloadFile: async function downloadFile() {
        await this.saveFile(this.data[this.number]);
        this.number < this.data.length ? this.downloadFile() : console.log('%c ****ä¸‹è½½æœ€åä¸€ä¸ªå•†å“é™„ä»¶****', 'color: green');
      },
      saveFile: function saveFile(list) {
        var _this2 = this;
    
        this.number++;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              list.value.forEach(function (item, index) {
                _this2.download(item.previewUrl, "".concat(list.name, "_").concat(index).concat(item.ext));
              });
            }());
          }, _this2.time);
        });
      }
    };
    index.init();</code></pre>
  <h3>5.ä¸Šä¼ å›¾ç‰‡</h3>
  <button class="btn" data-clipboard-target="#js5">ä¸€é”®å¤åˆ¶</button>
  <textarea id="js5">"use strict";

    var index = {
      init: function init() {
        this.number = $('.main-right-grid .editableCellCon')[0].classList[2].split('-')[1];
        this.time = 1000;
        this.addProductPicture();
      },
      //æ·»åŠ é™„ä»¶   
      addProductPicture: async function addProductPicture() {
        var table = $('.main-right-grid');
        var row = table.find(".row-".concat(this.number, ".col-1"));
        this.text = table.find(".row-".concat(this.number, ".col-4 span")).text();
        this.has = false;
        row.click();
        await this.openProduct();
        await this.openKnowledge();
    
        try {
          if (!this.has) {
            await this.folderSearch();
            await this.selectPicture();
            await this.enterPictrue();
            await this.savePicture();
          }
        } catch (e) {
          console.log("%c *****æœåŠ¡å™¨å¼‚å¸¸é‡æ–°å¼€å§‹***** ", 'color: red');
          this.addProductPicture();
        }
    
        await this.clickPicture();
        this.number++;
        this.has = true;
        row.length !== 0 && this.addProductPicture();
      },
      //æ‰“å¼€äº§å“   
      openProduct: function openProduct() {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æ‰“å¼€äº§å“***** ", 'color: red');
              $('.ming.Icon.icon-default.icon.icon-attachment.Font17').eq(0).click();
            }());
          }, _this.time * 5);
        });
      },
      //æ‰“å¼€çŸ¥è¯†åº“
      openKnowledge: function openKnowledge() {
        var _this2 = this;
    
        this.has = $('.UploadFiles-filesWrapper').is(":visible");
        if (this.has) return;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æ‰“å¼€çŸ¥è¯†åº“***** ", 'color: red');
              $('.UploadFiles-entrys').find('.flexRow.valignWrapper').eq(1).click();
            }());
          }, _this2.time);
        });
      },
      //æœç´¢
      folderSearch: function folderSearch() {
        var _this3 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æœç´¢å›¾ç‰‡***** ", 'color: red');
              $('.folderSearch input').val(_this3.text);
              $('.folderSearch .icon-search').click();
            }());
          }, _this3.time);
        });
      },
      //é€‰æ‹©å›¾ç‰‡
      selectPicture: function selectPicture() {
        var _this4 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****é€‰æ‹©å›¾ç‰‡***** ", 'color: red');
              $('.nodeList li').addClass('ThemeBGColor5').attr('nodetype', 2);
            }());
          }, _this4.time * 5);
        });
      },
      //ç¡®å®š
      enterPictrue: function enterPictrue() {
        var _this5 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****ç¡®å®šé€‰æ‹©***** ", 'color: red');
              $('#folderSelectDialog .yesText.boderRadAll_3.ThemeBGColor3')[0].click();
            }());
          }, _this5.time);
        });
      },
      //ä¿å­˜
      savePicture: function savePicture() {
        var _this6 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****ä¿å­˜æˆåŠŸ***** ", 'color: red');
              $('.updateRowButton .mRight24')[0].click();
            }());
          }, _this6.time * 5);
        });
      },
      //å…³é—­
      clickPicture: function clickPicture() {
        var _this7 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              $('.mui-dialog-close-btn')[0].click();
            }());
          }, _this7.time * 5);
        });
      }
    };
    index.init();</textarea>
  <pre><code class="js">"use strict";

    var index = {
      init: function init() {
        this.number = $('.main-right-grid .editableCellCon')[0].classList[2].split('-')[1];
        this.time = 1000;
        this.addProductPicture();
      },
      //æ·»åŠ é™„ä»¶   
      addProductPicture: async function addProductPicture() {
        var table = $('.main-right-grid');
        var row = table.find(".row-".concat(this.number, ".col-1"));
        this.text = table.find(".row-".concat(this.number, ".col-4 span")).text();
        this.has = false;
        row.click();
        await this.openProduct();
        await this.openKnowledge();
    
        try {
          if (!this.has) {
            await this.folderSearch();
            await this.selectPicture();
            await this.enterPictrue();
            await this.savePicture();
          }
        } catch (e) {
          console.log("%c *****æœåŠ¡å™¨å¼‚å¸¸é‡æ–°å¼€å§‹***** ", 'color: red');
          this.addProductPicture();
        }
    
        await this.clickPicture();
        this.number++;
        this.has = true;
        row.length !== 0 && this.addProductPicture();
      },
      //æ‰“å¼€äº§å“   
      openProduct: function openProduct() {
        var _this = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æ‰“å¼€äº§å“***** ", 'color: red');
              $('.ming.Icon.icon-default.icon.icon-attachment.Font17').eq(0).click();
            }());
          }, _this.time * 5);
        });
      },
      //æ‰“å¼€çŸ¥è¯†åº“
      openKnowledge: function openKnowledge() {
        var _this2 = this;
    
        this.has = $('.UploadFiles-filesWrapper').is(":visible");
        if (this.has) return;
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æ‰“å¼€çŸ¥è¯†åº“***** ", 'color: red');
              $('.UploadFiles-entrys').find('.flexRow.valignWrapper').eq(1).click();
            }());
          }, _this2.time);
        });
      },
      //æœç´¢
      folderSearch: function folderSearch() {
        var _this3 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****æœç´¢å›¾ç‰‡***** ", 'color: red');
              $('.folderSearch input').val(_this3.text);
              $('.folderSearch .icon-search').click();
            }());
          }, _this3.time);
        });
      },
      //é€‰æ‹©å›¾ç‰‡
      selectPicture: function selectPicture() {
        var _this4 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****é€‰æ‹©å›¾ç‰‡***** ", 'color: red');
              $('.nodeList li').addClass('ThemeBGColor5').attr('nodetype', 2);
            }());
          }, _this4.time * 5);
        });
      },
      //ç¡®å®š
      enterPictrue: function enterPictrue() {
        var _this5 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****ç¡®å®šé€‰æ‹©***** ", 'color: red');
              $('#folderSelectDialog .yesText.boderRadAll_3.ThemeBGColor3')[0].click();
            }());
          }, _this5.time);
        });
      },
      //ä¿å­˜
      savePicture: function savePicture() {
        var _this6 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              console.log("%c *****ä¿å­˜æˆåŠŸ***** ", 'color: red');
              $('.updateRowButton .mRight24')[0].click();
            }());
          }, _this6.time * 5);
        });
      },
      //å…³é—­
      clickPicture: function clickPicture() {
        var _this7 = this;
    
        return new Promise(function (resolve) {
          setTimeout(function () {
            return resolve(function () {
              $('.mui-dialog-close-btn')[0].click();
            }());
          }, _this7.time * 5);
        });
      }
    };
    index.init();</code></pre>
  <script>
    var clipboard = new ClipboardJS('.btn');

    clipboard.on('success', function (e) {
      console.info('Action:', e.action);
      console.info('Text:', e.text);
      console.info('Trigger:', e.trigger);
      alert('<h2>å¤åˆ¶æˆåŠŸğŸ˜­</h2>')
      // e.trigger.innerText = 'å¤åˆ¶æˆåŠŸ'
      // e.clearSelection();
    });
    window.alert = function (msg, callback) {
      var div = document.createElement("div");
      div.innerHTML = "<style type=\"text/css\">" +
        ".nbaMask { position: fixed; z-index: 1000; top: 0; right: 0; left: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); }                                                                                                                                                                       " +
        ".nbaMaskTransparent { position: fixed; z-index: 1000; top: 0; right: 0; left: 0; bottom: 0; }                                                                                                                                                                                            " +
        ".nbaDialog { position: fixed; z-index: 5000; width: 80%; max-width: 300px; top: 50%; left: 50%; -webkit-transform: translate(-50%, -50%); transform: translate(-50%, -50%); background-color: #fff; text-align: center; border-radius: 8px; overflow: hidden; opacity: 1; color: white; }" +
        ".nbaDialog .nbaDialogHd { padding: .2rem .27rem .08rem .27rem; }                                                                                                                                                                                                                         " +
        ".nbaDialog .nbaDialogHd .nbaDialogTitle { font-size: 17px; font-weight: 400; }                                                                                                                                                                                                           " +
        ".nbaDialog .nbaDialogBd { padding: 0 .27rem; font-size: 15px; line-height: 1.3; word-wrap: break-word; word-break: break-all; color: #000000; }                                                                                                                                          " +
        ".nbaDialog .nbaDialogFt { position: relative; line-height: 48px; font-size: 17px; display: -webkit-box; display: -webkit-flex; display: flex; }                                                                                                                                          " +
        ".nbaDialog .nbaDialogFt:after { content: \" \"; position: absolute; left: 0; top: 0; right: 0; height: 1px; border-top: 1px solid #e6e6e6; color: #e6e6e6; -webkit-transform-origin: 0 0; transform-origin: 0 0; -webkit-transform: scaleY(0.5); transform: scaleY(0.5); }               " +
        ".nbaDialog .nbaDialogBtn { display: block; -webkit-box-flex: 1; -webkit-flex: 1; flex: 1; color: lightseagreen; text-decoration: none; -webkit-tap-highlight-color: transparent; position: relative; margin-bottom: 0; }                                                                       " +
        ".nbaDialog .nbaDialogBtn:after { content: \" \"; position: absolute; left: 0; top: 0; width: 1px; bottom: 0; border-left: 1px solid #e6e6e6; color: #e6e6e6; -webkit-transform-origin: 0 0; transform-origin: 0 0; -webkit-transform: scaleX(0.5); transform: scaleX(0.5); }             " +
        ".nbaDialog a { text-decoration: none; -webkit-tap-highlight-color: transparent; }" +
        "</style>" +
        "<div id=\"dialogs2\" style=\"display: none\">" +
        "<div class=\"nbaMask\"></div>" +
        "<div class=\"nbaDialog\">" +
        "    <div class=\"nbaDialogHd\">" +
        "        <strong class=\"nbaDialogTitle\"></strong>" +
        "    </div>" +
        "    <div class=\"nbaDialogBd\" id=\"dialog_msg2\">å¼¹çª—å†…å®¹ï¼Œå‘ŠçŸ¥å½“å‰çŠ¶æ€ã€ä¿¡æ¯å’Œè§£å†³æ–¹æ³•ï¼Œæè¿°æ–‡å­—å°½é‡æ§åˆ¶åœ¨ä¸‰è¡Œå†…</div>" +
        "    <div class=\"nbaDialogHd\">" +
        "        <strong class=\"nbaDialogTitle\"></strong>" +
        "    </div>" +
        "    <div class=\"nbaDialogFt\">" +
        "        <a href=\"javascript:;\" class=\"nbaDialogBtn nbaDialogBtnPrimary\" id=\"dialog_ok2\">çŸ¥é“äº†</a>" +
        "    </div></div></div>";
      document.body.appendChild(div);

      var dialogs2 = document.getElementById("dialogs2");
      dialogs2.style.display = 'block';

      var dialog_msg2 = document.getElementById("dialog_msg2");
      dialog_msg2.innerHTML = msg;

      // var dialog_cancel = document.getElementById("dialog_cancel");
      // dialog_cancel.onclick = function() {
      // dialogs2.style.display = 'none';
      // };
      var dialog_ok2 = document.getElementById("dialog_ok2");
      var timer = null
      var hide = function () {
        dialogs2.style.display = 'none';
        callback && callback();
        clearTimeout(timer)
      };
      dialog_ok2.onclick = hide
      timer = setTimeout(hide, 3000)
    };

  </script>
</body>

</html>
